# Spreadsheet Analysis - Srikar Iyer
## The Sourcing and Motivation for the Data
---
As a Junior in high school, I, was abruptly sent home during the meteoric rise of COVID in New Jersey, at around March of 2019. While most high schoolers, included me, attended the vast majority of days before COVID, ironically, being in home made me more complacent and less likely to attend school. Hence, finding this dataset was a result of curiosity as to if my complacency was felt by highschoolers around America. And being in NYU and making friends from the NYC school system, my interest narrowed to schools in NYC. 
---
The dataset I worked with is called, "2016-17 - 2020-21 School End-of-Year Attendance and Chronic Absenteeism Data" provided by the New York City Department of Education in the 'csv' format. It provided statistics for each school and grade level for the amount of school days, year recorded, days present and absent for each student, total percentage of attendance, days contributing for being 'chronically absent', amount of students chronically absent, and percentage of students chronically absent. The dataset in question has the link: https://data.cityofnewyork.us/Education/2016-17-2020-21-School-End-of-Year-Attendance-and-/gqq2-hgxd. It was copied to a txt file found in the next section.
## Basic Data Munging
The the first 20 rows of data in the raw form are: 

|DBN   |School Name              |Grade             |Category    |Year   |# Total Days|# Days Absent|# Days Present|% Attendance|# Contributing 10+ Total Days and 1+ Pres Day|# Chronically Absent|% Chronically Absent|
|------|-------------------------|------------------|------------|-------|------------|-------------|--------------|------------|---------------------------------------------|--------------------|--------------------|
|01M015|P.S. 015 Roberto Clemente|All Grades        |All Students|2016-17|30601       |1994         |28607         |93.5        |196                                          |51                  |26.0                |
|01M015|P.S. 015 Roberto Clemente|All Grades        |All Students|2017-18|33264       |2078         |31186         |93.8        |196                                          |37                  |18.9                |
|01M015|P.S. 015 Roberto Clemente|All Grades        |All Students|2018-19|30887       |2278         |28609         |92.6        |192                                          |47                  |24.5                |
|01M015|P.S. 015 Roberto Clemente|All Grades        |All Students|2019-20|21101       |1500         |19601         |92.9        |204                                          |58                  |28.4                |
|01M015|P.S. 015 Roberto Clemente|All Grades        |All Students|2020-21|32686       |3931         |28755         |88.0        |199                                          |84                  |42.2                |
|01M015|P.S. 015 Roberto Clemente|PK in K-12 Schools|All Students|2016-17|2844        |s            |s             |s           |s                                            |s                   |s                   |
|01M015|P.S. 015 Roberto Clemente|PK in K-12 Schools|All Students|2017-18|2987        |220          |2767          |92.6        |18                                           |4                   |22.2                |
|01M015|P.S. 015 Roberto Clemente|PK in K-12 Schools|All Students|2018-19|2104        |245          |1859          |88.4        |15                                           |7                   |46.7                |
|01M015|P.S. 015 Roberto Clemente|PK in K-12 Schools|All Students|2019-20|1490        |198          |1292          |86.7        |15                                           |10                  |66.7                |
|01M015|P.S. 015 Roberto Clemente|PK in K-12 Schools|All Students|2020-21|2830        |467          |2363          |83.5        |18                                           |10                  |55.6                |
|01M015|P.S. 015 Roberto Clemente|0K                |All Students|2016-17|4949        |383          |4566          |92.3        |31                                           |10                  |32.3                |
|01M015|P.S. 015 Roberto Clemente|0K                |All Students|2017-18|4968        |359          |4609          |92.8        |28                                           |8                   |28.6                |
|01M015|P.S. 015 Roberto Clemente|0K                |All Students|2018-19|3491        |283          |3208          |91.9        |22                                           |6                   |27.3                |
|01M015|P.S. 015 Roberto Clemente|0K                |All Students|2019-20|3091        |288          |2803          |90.7        |30                                           |15                  |50.0                |
|01M015|P.S. 015 Roberto Clemente|0K                |All Students|2020-21|4685        |766          |3919          |83.6        |29                                           |15                  |51.7                |
|01M015|P.S. 015 Roberto Clemente|1                 |All Students|2016-17|5370        |304          |5066          |94.3        |35                                           |6                   |17.1                |
|01M015|P.S. 015 Roberto Clemente|1                 |All Students|2017-18|5551        |355          |5196          |93.6        |33                                           |6                   |18.2                |
|01M015|P.S. 015 Roberto Clemente|1                 |All Students|2018-19|5857        |543          |5314          |90.7        |35                                           |10                  |28.6                |
|01M015|P.S. 015 Roberto Clemente|1                 |All Students|2019-20|2871        |218          |2653          |92.4        |28                                           |9                   |32.1                |


This table was very good to work with and near the final product, but not perfect for a few reasons. However, it was good enough that all scrubbing was possible in the 'munge.py' file [https://github.com/dbdesign-assignments-spring2023/spreadsheet-analysis-srikar-iyer/blob/main/munge.py]. Munge used the method that I used for the data munging exercise: create a read file that reads the text in read format, and create an empty csv file in write format to return a csv with cleaned data. 
This looks like:
"with open("data/readme.txt", 'r') as inputfile, open("data/clean_data.csv", 'w') as outputfile:"
The readme.txt can be found here: [https://github.com/dbdesign-assignments-spring2023/spreadsheet-analysis-srikar-iyer/blob/main/data/readme.txt] and the clean_data.csv can be found here: [https://github.com/dbdesign-assignments-spring2023/spreadsheet-analysis-srikar-iyer/blob/main/data/clean_data.csv]
The actual munging, oftentimes meant correcting empty or N/A statistics. Certain statistics couldn't be found and these were marked 's', like in the table above. In the code, this was done with a fast skip: 
"if line.__contains__("s,s"):
        continue" 
The second problem was that the ID system in the first column was useless for me, so I combined the writing step with this munge in one step:
"outputfile.write(",".join(line.split(",")[1:]))". 
The [1:] skips the first column and writes the rest, as I envisioned. This concludes the munging step. Finally, a unique problem was that my file was massive; with over 
50,000 rows, any change would take up to a few minutes of runtime to process. However, it makes the results extractable very extensive and very accurate, since the sample taken is close to the true sample, as the data collection noted every school, with the munging removing less than 1% of the original data.

## Spreadsheet Analysis and Statistics
The spreadsheet can be found here: []. The first 11 columns were imported from clean_data.csv to start with. While not all columns were calculated on, they were all important
to understand how the statistics came to be. For instance, the total number of days and number of days present / absent put into context the next statistic, the percent of attendance per grade in each school. Then, I calculated 4 aggregate statistics on the percent of attendance and percent chronically absent, which were mean, max, min, and standard deviation. Standard deviation, max, and min were calculate with the usual commands, =STDEV, =MAX, and =MIN. Average, however, used a different command: =SUBTOTAL(). When the first input is 101, it calculates mean. Then, I created 2 new columns percent of attendance during COVID and percent chronically absent during COVID. To create this augmented data, I included only the rows with the 2019-20 and 2020-21 school years. Here, having the years column was vital to select the desired columns. Here, the drag and drop formula feature was vital, as I only needed to make 1 formula for the entire column. The formula was difficult to make; I had to select the dates with the "FIND" feature, for "-20" and "-21" to select the correct rows, "ISNUMBER" to create a boolean accepting or rejecting each row, "OR" to combine the 2 statements, and an "IF" statement on the outside to accept TRUE values, return the same column back, and a "" if FALSE in order to avoid an error message. The final function to create the columns are "=IF(OR(ISNUMBER(FIND("-20",D2)),ISNUMBER(FIND("-21",D2))),H2,"")", with the 2 replaced for the corresponding row number as the row numbers increased. Having created these columns, I created the same statistics mentioned above for the columns with COVID. I had a plan for the mean and standard deviation : I would make normal distribution graphs and analyze them here. I made 4 of these: for percent attendance, chronically absent, attendance with covid, and chronically absent with covid. To do this, I created 4 new columns of the 4 statistics involved with the sorted normal distribution of each original statistic. To do this, I used the command :"=NORM.DIST(H2, $O$2, $O$3, FALSE)". The 2nd and 3rd arguments were the mean and standard deviation, the first depicted each original stat, and FALSE toggled the exact probability distribution. To make the graph, then, simply setting the x-axis to be the original statistic and the y-axis as the normal distribution returned the corresponding bell curve. 

The graphs can be seen here : 
[https://github.com/dbdesign-assignments-spring2023/spreadsheet-analysis-srikar-iyer/blob/main/4gref.jpg]

These graphs put forth certain insights. The first, obvious observation is that the peak of the attendance graphs are to the right for both graphs at around 90%, while the peak of the absence graphs are to the left, at around 30%. The peaks represent the median, so over half of all grades in each school, at least 9 out of every 10 kids attend school, which makes sense.  Meanwhile, for over half the grade levels per school, atleast 30% of the students were chronically absent. This is reasonable, as the condition for chronically absent is a strict criteria, which is missing only 10 days per quarter. Also, certain low income neighborhoods, very busy parents, and unforseen circumstances  might force less attendance for some students. For the attendance graphs, 95% of the values are pretty close together, from 80 to 100% attendence, while the remaining 5% form a left tail. Because outliers affect the mean more, the value of the mean is a bit less than the peak, at around 89%. In contrast, for absences, the majority clustered at around 29%, with a large right tail. So, it makes sense that the mean is a bit larger, at 31%. Due to the law of large numbers, more values regress towards the mean, so it makes sense that the tails don't affect the mean too much. The COVID attendance graph was a bit shifted to the left, but maintained a similar mean regardless. Interestingly, the far outliers (those with 20-40% attendance) decreased, while the 2nd quartile (those with 60-80% attendace) fattened. This implies that during COVID, schools with the worst attendance benefitted since computers made it easier to attend. However, some of the average or well off schools suffered a little, as students might have been complacent or lazy. Through similar counteracting mechanisms, the mean attendance stayed the same. The same phenomenon was seen for the percent of students chronically absent during and before covid. Actually, the 2 graphs looked nearly the same, implying that everyone who skipped school at a certain rate continued skipping school. I think that because schools across the board contain students of varying work ethic and commitment to study, the absense statistic didn't change over time, due to the previous point. In fact, it could be local culture or wealth level which causes the outliers or trends to exist. 

## Extra-credit
This assignment deserves extra credit because the dataset analyzed is sufficiently large, at 50,000 rows. 
 